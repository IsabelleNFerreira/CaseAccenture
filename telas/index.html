<head>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
</head>

<body class="p-3 m-0 border-0 bd-example m-0 border-0">
  <div id="app">
    <h3 class="d-flex justify-content-center">Case Accenture - Isabelle Nunes</h3>
    </button>
    <table class="table table-striped">
      <thead>
        <tr>
          <th>NOME</th>
          <th>CNPJ</th>
          <th>CEP</th>
        </tr>
      <tbody>
        <h2 class="d-flex justify-content-center fst-italic">Empresas</h2>
        <h5 class="d-flex justify-content-center fst-italic">Informe abaixo as informações relacionadas a empresa para inserção:
        </h5>
        <form>
          <div class="row">
            <div class="input-group mb-3 col">
              <span class="input-group-text fw-bold" id="basic-addon1">Nome*</span>
              <input type="text" class="form-control" aria-describedby="basic-addon1">
            </div>
            <div class="input-group mb-3 col">
              <span class="input-group-text fw-bold" id="basic-addon1">CNPJ*</span>
              <input type="text" class="form-control" aria-describedby="basic-addon1">
            </div>
            <div class="input-group mb-3 col">
              <span class="input-group-text fw-bold" id="basic-addon1">CEP*</span>
              <input type="text" class="form-control" aria-describedby="basic-addon1">
            </div>
            <div class="mb-3 col">
              <button type="button" class="btn btn-info m-2 fload-end fw-bold" @click="addEmpClick()">
                Adicionar Empresa
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                  class="bi bi-check-lg" viewBox="0 0 16 16">
                  <path
                    d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.88 12.01a.733.733 0 0 1-1.065.02L3.217 8.384a.757.757 0 0 1 0-1.06.733.733 0 0 1 1.047 0l3.052 3.093 5.4-6.425z" />
                </svg>
              </button>
            </div>
          </div>
        </form>
        <tr v-for="emp in Empresa.empresas">
          <td>{{emp.NomeFantasia}}</td>
          <td>{{emp.CNPJ}}</td>
          <td>{{emp.CEP}}</td>
          <td class="d-flex justify-content-end">
            <button type="button" class="btn bnt-light mr-1" @click="editEmpClick(emp)">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                class="bi bi-pencil-fill" viewBox="0 0 16 16">
                <path
                  d="M12.854.146a.5.5 0 0 0-.707 0L10.5 1.793 14.207 5.5l1.647-1.646a.5.5 0 0 0 0-.708zm.646 6.061L9.793 2.5 3.293 9H3.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.207zm-7.468 7.468A.5.5 0 0 1 6 13.5V13h-.5a.5.5 0 0 1-.5-.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.5-.5V10h-.5a.5.5 0 0 1-.175-.032l-.179.178a.5.5 0 0 0-.11.168l-2 5a.5.5 0 0 0 .65.65l5-2a.5.5 0 0 0 .168-.11z" />
              </svg>
            </button>
            <button type="button" class="btn bnt-light mr-1" @click="deleteEmpClick(emp.EmpresaID)">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                class="bi bi-trash-fill" viewBox="0 0 16 16">
                <path
                  d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5M8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5m3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0" />
              </svg>
            </button>
          </td>
        </tr>
      </tbody>
      </thead>
    </table>
    <h2 class="mt-8 d-flex justify-content-center fst-italic">Fornecedores</h2>
    <h5 class="d-flex justify-content-center fst-italic">Clique no botão ao lado para ser direcionado para a tela de inserção:
    </h5>
    <div class="d-flex justify-content-center">
      <button type="button" class="btn btn-info m-2 fload-end fw-bold mr-1" @click="addForncClick()">
        Abrir tela de inserção de Fornecedores
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-up-right"
          viewBox="0 0 16 16">
          <path fill-rule="evenodd"
            d="M14 2.5a.5.5 0 0 0-.5-.5h-6a.5.5 0 0 0 0 1h4.793L2.146 13.146a.5.5 0 0 0 .708.708L13 3.707V8.5a.5.5 0 0 0 1 0z" />
        </svg>
      </button>
    </div>
    <table class="table table-striped">
      <thead>
        <tr>
          <th>NOME</th>
          <th>EMAIL</th>
          <th>CNPJ</th>
          <th>CPF</th>
          <th>RG</th>
          <th>DATA DE NASCIMENTO</th>
          <th>CEP</th>
        </tr>
      <tbody>
        <tr v-for="fornc in Fornecedores.fornecedores">
          <td>{{fornc.Nome}}</td>
          <td>{{fornc.Email}}</td>
          <td>{{fornc.CNPJ}}</td>
          <td>{{fornc.CPF}}</td>
          <td>{{fornc.RG}}</td>
          <td>{{fornc.DataNasc}}</td>
          <td>{{fornc.CEP}}</td>
          <td class="d-flex justify-content-end">
            <button type="button" class="btn bnt-light mr-1">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                class="bi bi-pencil-fill" viewBox="0 0 16 16">
                <path
                  d="M12.854.146a.5.5 0 0 0-.707 0L10.5 1.793 14.207 5.5l1.647-1.646a.5.5 0 0 0 0-.708zm.646 6.061L9.793 2.5 3.293 9H3.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.207zm-7.468 7.468A.5.5 0 0 1 6 13.5V13h-.5a.5.5 0 0 1-.5-.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.5-.5V10h-.5a.5.5 0 0 1-.175-.032l-.179.178a.5.5 0 0 0-.11.168l-2 5a.5.5 0 0 0 .65.65l5-2a.5.5 0 0 0 .168-.11z" />
              </svg>
            </button>
            </button>
            <button type="button" class="btn bnt-light mr-1">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                class="bi bi-trash-fill" viewBox="0 0 16 16">
                <path
                  d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5M8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5m3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0" />
              </svg>
            </button>
          </td>
        </tr>
      </tbody>
      </thead>
    </table>

    <h2 class="mt-8 d-flex justify-content-center fst-italic">Empresas e seus Fornecedores</h2>
    <h5 class="d-flex justify-content-center fst-italic">Na tabela a seguir é possivel visualizar as Empresas cadastradas que possuem vinculos com Fornecedores.
    <h5 class="d-flex justify-content-center fst-italic">Caso desejado, clique no botão ao lado para ser direcionado para a tela de vinculação:
    </h5>
    <div class="d-flex justify-content-center">
      <button type="button" class="btn btn-info m-2 fload-end fw-bold mr-1" @click="addForncClick()">
        Abrir tela de vinculação
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-up-right"
          viewBox="0 0 16 16">
          <path fill-rule="evenodd"
            d="M14 2.5a.5.5 0 0 0-.5-.5h-6a.5.5 0 0 0 0 1h4.793L2.146 13.146a.5.5 0 0 0 .708.708L13 3.707V8.5a.5.5 0 0 0 1 0z" />
        </svg>
      </button>
    </div>
    <table class="table table-striped">
      <thead>
        <tr>
          <th>NOME EMPRESA</th>
          <th>NOME FORNECEDOR</th>
        </tr>
      <tbody>
        <tr v-for="rel in Rel.rel">
          <td>{{rel.NomeFantasia}}</td>
          <td>{{rel.Nome}}</td>
          <td class="d-flex justify-content-end">
            <button type="button" class="btn bnt-light mr-1">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                class="bi bi-pencil-fill" viewBox="0 0 16 16">
                <path
                  d="M12.854.146a.5.5 0 0 0-.707 0L10.5 1.793 14.207 5.5l1.647-1.646a.5.5 0 0 0 0-.708zm.646 6.061L9.793 2.5 3.293 9H3.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.207zm-7.468 7.468A.5.5 0 0 1 6 13.5V13h-.5a.5.5 0 0 1-.5-.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.5-.5V10h-.5a.5.5 0 0 1-.175-.032l-.179.178a.5.5 0 0 0-.11.168l-2 5a.5.5 0 0 0 .65.65l5-2a.5.5 0 0 0 .168-.11z" />
              </svg>
            </button>
            </button>
            <button type="button" class="btn bnt-light mr-1">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                class="bi bi-trash-fill" viewBox="0 0 16 16">
                <path
                  d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5M8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5m3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0" />
              </svg>
            </button>
          </td>
        </tr>
      </tbody>
      </thead>
    </table>
  </div>
</body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.7.2/axios.min.js"
  integrity="sha512-JSCFHhKDilTRRXe9ak/FJ28dcpOJxzQaCd3Xg8MyF6XFjODhy/YMCM8HW0TFDckNHWUewW+kfvhin43hKtJxAw=="
  crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script type="module">
  import { createApp, ref } from 'https://unpkg.com/vue@3/dist/vue.esm-browser.js'
  const API_URL = "http://localhost:5223/";
  createApp({
    data() {
      return {
        Empresa: {
          empresas: []

        },
        Fornecedores: {
          fornecedores: []
        },
        Rel: {
          rel: []
        }
      }
    },
    // Declaração dos métodos responsáveis por realizar as requisições ao backend
    methods: {
      async refreshData() {
        try {
          axios.get(API_URL + "api/Empresa/GetEmpresas").then(
            (response) => {
              this.Empresa.empresas = response.data;
            }
          )
          axios.get(API_URL + "api/Fornecedor/GetFornecedores").then(
            (response) => {
              this.Fornecedores.fornecedores = response.data;
            }
          )
          axios.get(API_URL + "api/RelEmpresaFornecedores/GetRelEmpresaFornecedores").then(
            (response) => {
              this.Rel.rel = response.data;
            }
          )
        }
        catch (error) {
          console.error(error)
        }
      },
      // Funções de Inclusão e Deleção de Empresas para serem implementadas futuramente
      async addEmpClick() {
        var newEmpresa = document.getElementById("newEmpresa").value;
        const formData = new FormData();
        formData.append("newEmpresa", newEmpresa);
        axios.post(API_URL + "api/Empresa/PostEmpresas", formData).then(
          (response) => {
            this.refreshData();
            alert(response.data);
          }
        )
      },
      async deleteEmpClick(id) {
        axios.delete(API_URL + "api/Empresa/DeleteEmpresas?EmpresaID=" + id).then(
          (response) => {
            this.refreshData();
            alert(response.data);
          }
        )
      },
    }
    , mounted: function () {
      this.refreshData();
    }
  }).mount('#app')
</script>